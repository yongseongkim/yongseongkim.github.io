<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Introduction to Steganography | yongseongkim&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://yongseongkim.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://yongseongkim.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://yongseongkim.github.io/blog/2020/02/09/introduction-to-steganography/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Introduction to Steganography | yongseongkim&#x27;s blog"><meta data-rh="true" name="description" content="2020 년 새해를 맞아 사내 개발팀 워크샵 라이트닝 톡 발표를 위해 준비한 소재 Steganography 정리해봤습니다."><meta data-rh="true" property="og:description" content="2020 년 새해를 맞아 사내 개발팀 워크샵 라이트닝 톡 발표를 위해 준비한 소재 Steganography 정리해봤습니다."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-02-09T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="steganography"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://yongseongkim.github.io/blog/2020/02/09/introduction-to-steganography/"><link data-rh="true" rel="alternate" href="https://yongseongkim.github.io/blog/2020/02/09/introduction-to-steganography/" hreflang="en"><link data-rh="true" rel="alternate" href="https://yongseongkim.github.io/blog/2020/02/09/introduction-to-steganography/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="yongseongkim&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="yongseongkim&#39;s blog Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TJY4YF1TRD"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TJY4YF1TRD",{anonymize_ip:!0})</script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.068f18cf.css">
<link rel="preload" href="/assets/js/runtime~main.4fcedfaa.js" as="script">
<link rel="preload" href="/assets/js/main.da052b4e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="yongseongkim&#x27;s blog" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="yongseongkim&#x27;s blog" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">yongseongkim&#x27;s blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/blog/tags/">Tags</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/06/22/lotto-bot/">Auto Lotto Bot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/03/10/game-synchronizations/">Synchronization Techniques in Game Development</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/09/25/uilabel-alignment/">UILabel Alignment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/06/25/how-to-open-app-by-url/">How To Open An App By URL</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/06/14/swift-memory-management/">Memory Management in Swift</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/05/26/swiftui-data-flow-patterns/">SwiftUI - Data Flow Patterns</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/05/25/swiftui-layout-system/">SwiftUI - Layout System</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2020/02/09/introduction-to-steganography/">Introduction to Steganography</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/02/02/alphago-zero/">AlphaGo Paper Review (2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/01/19/alphago-lee/">AlphaGo Paper Review</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Introduction to Steganography</h1><div class="container_mt6G margin-vert--md"><time datetime="2020-02-09T00:00:00.000Z" itemprop="datePublished">February 9, 2020</time> · <!-- -->15 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>2020 년 새해를 맞아 <a href="http://engineering.vcnc.co.kr/2019/01/vcnc-workshop-for-developers/" target="_blank" rel="noopener noreferrer">사내 개발팀 워크샵</a> 라이트닝 톡 발표를 위해 준비한 소재 Steganography 정리해봤습니다.</p><h1>What is Steganography?</h1><p>Steganography 는 메시지를 숨길 때 사용하는 기술로 다른 집단 혹은 개인에게 들키지 않고 메시지를 전달하는 게 목적입니다. 현대에서는 Watermarking 이나 FingerPrint 분야에서도 쓰입니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steganography-vs-encryption">Steganography vs. Encryption<a href="#steganography-vs-encryption" class="hash-link" aria-label="Direct link to Steganography vs. Encryption" title="Direct link to Steganography vs. Encryption">​</a></h2><p>Encryption 은 모든 사람이 메세지를 볼 수 있습니다. 하지만 정보를 얻으려면 암호화된 메세지를 풀 수 있는 열쇠가 필요하죠. 그래서 Encryption 은 풀기보다 못 읽게 하거나 없애는 게 더 쉽습니다.
Steganography 는 메시지 존재 자체를 숨기는 기술입니다. 전달하는 사람과 받는 사람 이외에 사람들은 비밀리에 메시지를 주고 받는 것도 모를 수 있습니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="history">History<a href="#history" class="hash-link" aria-label="Direct link to History" title="Direct link to History">​</a></h2><p>Steganography 의 역사는 기원전 440년부터 시작합니다. 고대 그리스에서는 나무에 메시지를 적고 왁스로 덮는 방식을 이용했다고 합니다.
히스타이오스(Histiaeus)는 그리스에게 페르시안 공격을 전하기 위해 친애하는 노예의 머리를 밀고 메시지를 타투로 새겼습니다. 머리가 자라면서 메시지는 숨겨졌습니다.</p><p><img loading="lazy" src="http://4.bp.blogspot.com/-I-EUME4witY/TZbFjKb22SI/AAAAAAAAAGQ/0dJPgTDOo6w/s200/hh.jpg" alt="Tattoo on Head hidden by hair" class="img_ev3q"></p><p>출처: <a href="https://hareenlaks.blogspot.com/2011/04/history-of-steganography.html" target="_blank" rel="noopener noreferrer">hareenlaks&#x27;s blog</a></p><p>세계 2차 대전에는 프랑스 저항군이 보이지 않는 잉크를 이용하여 메시지를 전달했습니다. 또한 간첩들은 microdots 을 이용해서 비밀 메시지를 담은 이미지를 생성하고 사용했습니다.
microdots 을 종이에 적고 collodion 용액으로 덮었습니다. 메시지는 빛을 비추면 보였습니다.
인형 딜러로 위장한 스파이는 얼마나 많은 인형을 배에 실을지에 대한 주문서에 메시지를 숨겨 배의 움직임을 알렸습니다.</p><p><img loading="lazy" src="http://1.bp.blogspot.com/-sWs2AStWpSI/TZbHnlrF3WI/AAAAAAAAAGY/C5RmqQOS7WM/s1600/md.jpg" alt="Enlarge view of a microdot" class="img_ev3q"></p><p>출처: <a href="https://hareenlaks.blogspot.com/2011/04/history-of-steganography.html" target="_blank" rel="noopener noreferrer">hareenlaks&#x27;s blog</a></p><p>또한 911 테러에도 오사마 빈라덴이 테러에 스테가노그래피를 이용했다고 합니다. <a href="https://usatoday30.usatoday.com/life/cyber/tech/2001-02-05-binladen.htm" target="_blank" rel="noopener noreferrer">포르노 사진, 스포츠 채팅 창에서의 글들을 이용하여 미국 테러에 대한 지령을 전달했다고 합니다.</a></p><h1>Techniques for Steganography</h1><p>위의 역사에서 보듯이 메시지를 숨기는 방법은 다양합니다. 간단하게 사용되고 있는 여러 기술들을 소개하겠습니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="binary-file-techniques">Binary File Techniques<a href="#binary-file-techniques" class="hash-link" aria-label="Direct link to Binary File Techniques" title="Direct link to Binary File Techniques">​</a></h2><p>CopyRight 를 프로그램 내에 새기는 방법 중 하나입니다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">b = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c = b + 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d = b + c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위와 같은 코드에서 <code>a = 1</code> 의 위치는 중요하지 않습니다. <code>a = 1</code> 의 위치를 통해서 0 과 1 을 표현할 수 있습니다.
이 방법을 이용하기 위해 먼저 전체 코드를 n 개의 블락으로 나눕니다. 이렇게 나눈 n 개의 블락에서 <code>a = 1</code> 와 같은 코드의 위치를 변경하거나 그대로 둠으로써 숨기려는 메시지를 n 자리 이진수로 표현합니다.</p><p>[<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, ..., <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">w_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>]<!-- --> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></span> or <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span>)</p><p>이렇게 작업한 파일과 원본 파일을 비교해서 삽입된 메시지를 추출할 수 있습니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="text-techniques">Text Techniques<a href="#text-techniques" class="hash-link" aria-label="Direct link to Text Techniques" title="Direct link to Text Techniques">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whitespace-manipulation">Whitespace Manipulation<a href="#whitespace-manipulation" class="hash-link" aria-label="Direct link to Whitespace Manipulation" title="Direct link to Whitespace Manipulation">​</a></h3><p>여백을 이용하는 여러 방법이 있습니다. 그 중 하나로 Line Shift 가 있습니다. 문서의 라인을 미세하게 올리거나 내려서 0 과 1 을 표현합니다. 약 1/300 인치를 이동시키기 때문에 사람의 눈으로는 파악하기가 힘듭니다. 또 Line Shift 와 비슷하게 Word Shift 가 있습니다. 단어를 아래 그림과 같이 왼쪽 오른쪽으로 미세하게 이동시켜 0 과 1을 표현할 수 있습니다.</p><p><img loading="lazy" alt="Word Shift Coding Example" src="/assets/images/text-technique-word-shift-coding-54ad6019922f38f34d1deed49e18bddf.png" width="568" height="98" class="img_ev3q"></p><p>또한 글 단락 사이라던지 문장의 끝에 특정 양의 빈 여백을 넣어 메시지를 표현할 수도 있습니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="feature-coding">Feature Coding<a href="#feature-coding" class="hash-link" aria-label="Direct link to Feature Coding" title="Direct link to Feature Coding">​</a></h3><p>다양한 특성들을 이용하는 방법입니다. 예를 들면 특정 글자의 높이라던지 i 와 j 의 점을 이용하거나 f 와 t 처럼 수평적인 획의 길이를 이용하기도 합니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xml">XML<a href="#xml" class="hash-link" aria-label="Direct link to XML" title="Direct link to XML">​</a></h3><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> -&gt; 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"> -&gt; 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">favorite</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">fruit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">SOMETHING</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">fruit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">favorite</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> -&gt; 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">fruit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">favorite</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">SOMETHING</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">favorite</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">fruit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> -&gt; 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위와 같이 데이터에 영향을 주지 않는 일정한 규칙을 통해 메시지를 나타낼 수 있습니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="image-techniques">Image Techniques<a href="#image-techniques" class="hash-link" aria-label="Direct link to Image Techniques" title="Direct link to Image Techniques">​</a></h2><p>이미지를 이용한 간단한 방법을 소개합니다. 해킹 챌린지 사이트 <a href="http://www.wechall.net/challenge/training/" target="_blank" rel="noopener noreferrer">Wechall</a> 에서도 이미지와 관련된 steganography 문제를 다루고 있습니다.
해당 사이트에서 stegano1 디렉토리에 들어가면 아래와 같은 이미지를 볼 수 있습니다. 실제 크기는 굉장히 작습니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example" src="/assets/images/img-technique-wechall-example-4145f5e132c3fe13a81fba088f095211.png" width="188" height="192" class="img_ev3q"></p><p>이 파일을 읽으면 <code>BMf6(0Look what the hex-edit revealed: passwd:steganoI</code> 와 같은 메시지를 볼 수 있습니다. 이와 같이 단순한 이미지를 통해 메시지를 담는 방법을 알아보겠습니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="insertion">Insertion<a href="#insertion" class="hash-link" aria-label="Direct link to Insertion" title="Direct link to Insertion">​</a></h3><p>파일마다 끝을 나타내는 EOF 바이트가 존재합니다. JPEG의 경우에는 <code>FF D9</code> 바이트로 끝나고 PNG 의 경우에는 <code>89 50 4E 47 0D 0A 1A 0A</code> 값으로 시작합니다. 파일이 끝났음을 나타내는 바이트 뒤 데이터는 무시합니다. 이 원리를 이용하여 파일이 끝났음을 나타내는 바이트 뒤로 데이터를 숨길 수 있습니다. 끝에 숨기는 것과 비슷하게 헤더에도 데이터를 숨길 수 있습니다. 파일 헤더 중 이미지에 영향을 주지 않는 부분에 데이터를 숨길 수 있습니다.
<a href="http://www.wechall.net/challenge/training/stegano/attachment/" target="_blank" rel="noopener noreferrer">Wechall</a> 에 들어가면 아래와 같은 이미지를 다운 받을 수 있습니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - Insertion" src="/assets/images/img-technique-wechall-insertion-66a689633faf58d4bde68c3e99177419.png" width="221" height="350" class="img_ev3q"></p><p>단순히 이미지만 보면 예전에 인기를 끌었던 표지입니다.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;./ghostbusters.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;rb&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    b </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bytearray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위 이미지를 bytearray 로 읽어오는 파이썬 코드를 작성해봅니다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(생략)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x4a 0x3 0xff 0xd9 0x50 0x4b 0x3 0x4 0xa 0x0 0x0 0x0 0x0 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x43 0x46 0x3a 0x50 0x26 0xbd 0xd2 0xfd 0xc 0x0 0x0 0x0 0xc 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0 0x0 0xc 0x0 0x0 0x0 0x73 0x6f 0x6c 0x75 0x74 0x69 0x6f 0x6e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x2e 0x74 0x78 0x74 0x43 0x42 0x4e 0x53 0x50 0x45 0x42 0x41 0x45</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x47 0x48 0x41 0x50 0x4b 0x1 0x2 0x3f 0x3 0xa 0x0 0x0 0x0 0x0 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x43 0x46 0x3a 0x50 0x26 0xbd 0xd2 0xfd 0xc 0x0 0x0 0x0 0xc 0x0 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0 0xc 0x0 0x0 0x0 0x0 0x0 0x0 0x0 0x0 0x0 0x0 0x0 0xb6 0x81 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0 0x0 0x0 0x73 0x6f 0x6c 0x75 0x74 0x69 0x6f 0x6e 0x2e 0x74 0x78</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x74 0x50 0x4b 0x5 0x6 0x0 0x0 0x0 0x0 0x1 0x0 0x1 0x0 0x3a 0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0 0x0 0x36 0x0 0x0 0x0 0x0 0x0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>여기서 자세히 보면 JPEG Footer Signature 인 <code>0xff 0xd9</code> 값을 찾을 수 있습니다. 파일이 끝났다는 signature 이후에도 많은 데이터가 있는 것으로 보아 이 부분만을 추출해봅니다.
이후에 바로 이어지는 <code>0x50 0x4B 0x3 0x4</code> 는 ZIP Header Signature 이기도 합니다.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">another </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x50&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x4b&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x3&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x4&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    another </span><span class="token operator">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;./ghosterbusters-extract.zip&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;wb&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">another</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>파이썬을 이용하여 JPEG 이후 데이터를 ZIP 파일로 저장합니다. 이후 압축을 풀면 &#x27;solution.txt&#x27; text file 을 얻을 수 있습니다.
<code>solution.text</code> 에는 <code>CBNSPEBAEGHA</code> 와 같은 코드명이 담겨있네요.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lsb">LSB<a href="#lsb" class="hash-link" aria-label="Direct link to LSB" title="Direct link to LSB">​</a></h3><p>다음으로 알아 볼 방법은 LSB (Least Significant Bit) 입니다. 24 비트 이미지 파일은 RGB 를 각 8비트씩 이용하여 색을 표현합니다.
여기서 1비트만 수정하여 메시지를 숨길 수 있습니다. 1비트만 수정하기 때문에 사람 눈으로는 알아채기 쉽지 않습니다.</p><p><a href="http://www.wechall.net/challenge/training/stegano/LSB/" target="_blank" rel="noopener noreferrer">Wechall</a> 에서도 LSB 에 대한 문제를 찾을 수 있습니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - LSB" src="/assets/images/img-technique-wechall-lsb-a7623aff743c75621eaa7920e782af57.png" width="480" height="212" class="img_ev3q"></p><p>위 그림만 보면 전자제품의 부품 같네요. 이 이미지를 OpenCV 를 이용하여 풀어보겠습니다.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> cv2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img </span><span class="token operator">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imread</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;./lsb.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">IMREAD_COLOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">idx </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bit </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> idx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Blue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">bitwise_and</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">full</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Green</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Red</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">img </span><span class="token operator">==</span><span class="token plain"> bit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">255</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cv2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imwrite</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;./lsb-modified.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>해당 이미지를 읽어 RGB 에 해당하는 LSB 와 AND 연산을 하는 코드입니다.</p><p>아래 이미지는 BLUE 0 번 비트와 AND 연산한 결과입니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - LSB - 0" src="/assets/images/img-technique-wechall-lsb-idx0-8e8906277c998724d21de4bafac8bdd1.png" width="480" height="212" class="img_ev3q"></p><p>아래 이미지는 BLUE 1 번 비트와 AND 연산한 결과입니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - LSB - 0" src="data:image/png;base64,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" width="480" height="212" class="img_ev3q"></p><p>위와 같이 메세지가 숨겨져 있는 것을 볼 수 있습니다.
이 방법은 비트가 올라가면 올라갈수록 원 이미지를 훼손하게 됩니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - LSB - Bit Used" src="/assets/images/img-technique-lsb-bit-used-a6b33cf0224d3294f10b20eea65073af.jpg" width="576" height="416" class="img_ev3q"></p><p>출처: <a href="https://www.cs.bham.ac.uk/~mdr/teaching/modules03/security/students/SS5/Steganography.htm" target="_blank" rel="noopener noreferrer">Steganography And Digital WaterMarking</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deep-learning">Deep Learning<a href="#deep-learning" class="hash-link" aria-label="Direct link to Deep Learning" title="Direct link to Deep Learning">​</a></h3><p>마지막으로 알아볼 기술은 Deep Learning 을 이용한 기술입니다. 아래 그림과 같은 네트워크를 이용하여 이미지를 만들어냅니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - Deep Learning Network" src="/assets/images/img-technique-deep-learning-network-be005b6e4f661dc562774f2f12d83bfe.png" width="1183" height="321" class="img_ev3q"></p><p>출처: <a href="https://buzzrobot.com/hiding-images-using-ai-deep-steganography-b7726bd58b06" target="_blank" rel="noopener noreferrer">Hiding Images using AI — Deep Steganography</a></p><p>숨기려는 이미지 (Secret Image) 와 포장하려는 이미지 (Cover Image) 를 Input 으로 Covered Output 을 만듭니다. 그리고 이를 해석할 Reveal Network 를 통해 다시 Secret 이미지를 추출합니다.
여기서에 오차는 (Input 으로 사용한 Cover 이미지 - 비밀이미지를 담은 결과물) + (Input 으로 사용한 Secret 이미지 - Reveal Network 으로 뽑아낸 Secret 이미지) 로 합니다.</p><p><img loading="lazy" alt="Stegenography Image Technique Example - Deep Learning" src="/assets/images/img-technique-deep-learning-17b926823a3cc86c371f555e065c0746.png" width="1172" height="654" class="img_ev3q"></p><p>출처: <a href="https://buzzrobot.com/hiding-images-using-ai-deep-steganography-b7726bd58b06" target="_blank" rel="noopener noreferrer">Hiding Images using AI — Deep Steganography</a></p><p>위 사진은 이전에 설명한 네트워크의 결과물입니다. 더 자세한 내용은 해당 블로그 <a href="https://buzzrobot.com/hiding-images-using-ai-deep-steganography-b7726bd58b06" target="_blank" rel="noopener noreferrer">Hiding Images using AI</a> 참고하시면 됩니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sound-techniques">Sound Techniques<a href="#sound-techniques" class="hash-link" aria-label="Direct link to Sound Techniques" title="Direct link to Sound Techniques">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spectogram">Spectogram<a href="#spectogram" class="hash-link" aria-label="Direct link to Spectogram" title="Direct link to Spectogram">​</a></h3><p>Spectogram 은 소리나 파동을 시각화하는 방법입니다. 시간축, 주파수 축 변화에 따라 진폭의 차이를 색상의 차이로 나타냅니다. 이와 같이 소리에도 메시지를 숨길 수 있습니다.</p><p><img loading="lazy" alt="Stegenography Sound Technique Example" src="/assets/images/sounnd-technique-example-622e0523c29dcbd3183fc7eb99d1abb7.png" width="250" height="225" class="img_ev3q"></p><p><a href="http://www.bastwood.com/?page_id=10" target="_blank" rel="noopener noreferrer">The Apex Face</a> 의 글을 보시면 재밌는 이미지를 볼 수 있습니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="echo-hiding">Echo Hiding<a href="#echo-hiding" class="hash-link" aria-label="Direct link to Echo Hiding" title="Direct link to Echo Hiding">​</a></h3><p>에코를 이용하여 데이터를 숨기는 방법도 있습니다. 진폭, Decay 비율, Offset 을 사람들이 알아채지 못할 정도로 설정하여 메시지를 전달합니다.</p><h1>Conclusion</h1><p>메시지를 숨기는 간단한 방법들을 알아봤습니다. Sound Technique 에는 1940년 대 군에서 많이 쓰인 Spread Spectrum, Parity Bit 개념을 이용한 Parity Coding, 사람들이 파악하기 힘든 Phase 변조를 통한 Phase Coding 등이 있습니다.
또한 이미지와 소리 기술은 비디오에서도 적용할 수 있습니다. 현대에서는 Watermarking 문제를 위해 이러한 기술들이 발전되고 있으니 다른 기술들도 찾아보시면 재밌겠네요.</p><h1>Reference</h1><ul><li><a href="http://hareenlaks.blogspot.com/2011/04/history-of-steganography.html#more" target="_blank" rel="noopener noreferrer">Steganography 의 역사</a></li><li><a href="https://bpsecblog.wordpress.com/2016/08/21/amalmot_4/" target="_blank" rel="noopener noreferrer">Wechall 문제 해석</a></li><li><a href="https://www.cs.bham.ac.uk/~mdr/teaching/modules03/security/students/SS5/Steganography.htm" target="_blank" rel="noopener noreferrer">Steganography And Digital Watermarking</a></li><li><a href="https://buzzrobot.com/hiding-images-using-ai-deep-steganography-b7726bd58b06" target="_blank" rel="noopener noreferrer">Hiding Images using AI</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/steganography/">steganography</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2020/05/25/swiftui-layout-system/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">SwiftUI - Layout System</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2019/02/02/alphago-zero/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">AlphaGo Paper Review (2)</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#steganography-vs-encryption" class="table-of-contents__link toc-highlight">Steganography vs. Encryption</a></li><li><a href="#history" class="table-of-contents__link toc-highlight">History</a></li><li><a href="#binary-file-techniques" class="table-of-contents__link toc-highlight">Binary File Techniques</a></li><li><a href="#text-techniques" class="table-of-contents__link toc-highlight">Text Techniques</a><ul><li><a href="#whitespace-manipulation" class="table-of-contents__link toc-highlight">Whitespace Manipulation</a></li><li><a href="#feature-coding" class="table-of-contents__link toc-highlight">Feature Coding</a></li><li><a href="#xml" class="table-of-contents__link toc-highlight">XML</a></li></ul></li><li><a href="#image-techniques" class="table-of-contents__link toc-highlight">Image Techniques</a><ul><li><a href="#insertion" class="table-of-contents__link toc-highlight">Insertion</a></li><li><a href="#lsb" class="table-of-contents__link toc-highlight">LSB</a></li><li><a href="#deep-learning" class="table-of-contents__link toc-highlight">Deep Learning</a></li></ul></li><li><a href="#sound-techniques" class="table-of-contents__link toc-highlight">Sound Techniques</a><ul><li><a href="#spectogram" class="table-of-contents__link toc-highlight">Spectogram</a></li><li><a href="#echo-hiding" class="table-of-contents__link toc-highlight">Echo Hiding</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 yongseongkim</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4fcedfaa.js"></script>
<script src="/assets/js/main.da052b4e.js"></script>
</body>
</html>